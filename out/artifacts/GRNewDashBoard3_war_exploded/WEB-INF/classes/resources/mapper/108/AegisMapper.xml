<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ht.mappergenerator.AegisMapper" >
    <resultMap id="ResultMap" type="ht.model.AegisModel" extends="BaseResultMap" >
        <result column="Name" property="name" jdbcType="LONGVARCHAR" />
    </resultMap>
    <select id="selectStockByIdentifier" parameterType="ht.model.AegisModel" resultMap="ResultMap">
        select
            II.Identifier, FRB.Name, SL.Identifier as 'historyStock', DATEADD(HOUR,8,IIH.TimePosted_BaseDateTimeUTC) AS 'localtime'
        from
            ItemInventories II
            left join FactoryResourceBases FRB
                on FRB.ID = II.StockResourceID
            left join ItemInventoryHistories IIH
                on IIH.ItemInventoryID = II.ID
            left join StockLocations SL
                on SL.ID = IIH.StockLocationID
        where
            II.Identifier = ${identifier} and SL.Identifier is not null
        order by IH.TimePosted_BaseDateTimeUTC desc
    </select>
</mapper>